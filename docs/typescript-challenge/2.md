# TypeScript å¤§æŒ‘æˆ˜ï¼ˆäºŒï¼‰

è¿™æ˜¯ TypeScript å¤§æŒ‘æˆ˜ç³»åˆ—çš„ç¬¬ 2 ç¯‡ï¼Œç¬”è€…è®¡åˆ’ç”¨ 6 ä¸ªæœˆæ—¶é—´å®Œæˆ [type-challenges](https://github.com/type-challenges/type-challenges "type-challenges") é¡¹ç›®ä¸­çš„ 133 ä¸ªæŒ‘æˆ˜å¹¶è®°å½•ä¸‹è‡ªå·±çš„æ”¶è·ï¼Œç›®å‰è¿˜å‰©ä½™ 130 ä¸ªï¼Œæˆªæ­¢æ—¥æœŸä¸º 2023 å¹´ 1 æœˆ25 æ—¥ã€‚

![æŒ‘æˆ˜è¿›åº¦](./public/1-progress.png)

## 4. æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ 

### æŒ‘æˆ˜å†…å®¹

å®ç°ä¸€ä¸ªé€šç”¨ `First<T>`ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ T å¹¶è¿”å›å®ƒç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ã€‚

``` typescript
// TODO: è¡¥å…… First ä»£ç 
type First<T extends any[]> = any

type arr1 = ['a', 'b', 'c']
type arr2 = [3, 2, 1]

type head1 = First<arr1> // ä¸º 'a'
type head2 = First<arr2> // ä¸º 3
type head3 = First<[]> // ä¸º never
```

> çŸ¥è¯†ç‚¹ï¼š`infer / never`

### é¢˜ç›®è§£æ

ä¸ºäº†å–å¾—æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œè‡ªç„¶è€Œç„¶çš„æƒ³æ³•å°±æ˜¯é€šè¿‡ `T[0]` è¿™ç§ä¸‹æ ‡çš„æ–¹å¼è®¿é—®ï¼Œä½†æ˜¯è¿™æ ·ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š*å¯¹äºç©ºæ•°ç»„ï¼Œå¾—åˆ°çš„ç±»å‹ä¸º undefined è€Œä¸æ˜¯ never*ï¼Œä¾‹å¦‚ï¼š

``` typescript
type First<T extends any[]> = T[0]

type head = First<[]> // ä¸º undefined
```

ç„¶è€Œé¢˜ç›®è¦æ±‚å¯¹äºç©ºæ•°ç»„è¿”å› `never`ï¼Œè¿™ä¹Ÿæ˜¯æ›´åˆç†çš„è¡Œä¸ºï¼Œå› ä¸ºæ­¤æ—¶çš„ç¡®ä¸å­˜åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå¯¹åº” never çš„å«ä¹‰ï¼‰ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

å¯èƒ½æœ‰åŒå­¦ä¼šæƒ³å‡º `type First<T extends any[]> = T['length'] >= 1 ? T[0] : never` è¿™æ ·çš„å°è¯•ï¼Œä½†æ˜¯ `T['length']` æ‹¿åˆ°çš„å…¶å®æ˜¯é•¿åº¦ `number` è¿™ä¸ªç±»å‹ï¼Œè€Œä¸æ˜¯ T çš„é•¿åº¦è¿™ä¸ªå€¼ï¼Œ`number` è¿™ä¸ªç±»å‹æ˜¯æ²¡åŠæ³•ç›´æ¥å’Œå€¼ 1 è¿›è¡Œæ¯”è¾ƒçš„ã€‚

åƒè¿™ç§åœ¨æ¡ä»¶è¯­å¥ä¸­æ‹¿åˆ°å¾…æ¨æ–­ç±»å‹çš„åœºæ™¯ï¼Œå°±éœ€è¦ç”¨åˆ° `infer` äº†ã€‚å®ƒå’Œ `extends` æ­é…åœ¨ä¸€èµ·ï¼Œèƒ½å¤Ÿåœ¨ `X extends Y` ä¸º true çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨é€šè¿‡ `infer` æ¨æ–­å¾—åˆ°çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š

``` typescript
type ArrayElementType<T>
  = T extends (infer E)[] ? E : never;

// item1 ä¸º number
type item1 = ArrayElementType<number[]>

// item2 ä¸º never
type item2 = ArrayElementType<number>
```

### é¢˜ç›®ç­”æ¡ˆ

å…³é”®ç‚¹åœ¨äºå°† `any[]` è§£æ„æˆ `[infer Head, ...any[]]`ï¼Œè¿™æ ·å°±å¯ä»¥æ‹¿åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œå¹¶åœ¨ Head ä¸å­˜åœ¨çš„æ—¶å€™è¿”å› neverï¼š

``` typescript
type First<T extends any[]>
  = T extends [infer Head, ...any[]] 
    ? Head : never
```

## 5. è·å–å…ƒç»„é•¿åº¦

### æŒ‘æˆ˜å†…å®¹

åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ `Length`ï¼Œæ¥å—ä¸€ä¸ª `readonly` çš„æ•°ç»„ï¼Œè¿”å›è¿™ä¸ªæ•°ç»„çš„é•¿åº¦ï¼š

``` typescript
// TODO: å®ç° Length
type Length<T> = any

type tesla = ['tesla']
type spaceX = [
  'FALCON 9',
  'FALCON HEAVY',
]

// teslaLength ä¸º 1
type teslaLength = Length<tesla>

// spaceXLength ä¸º 2
type spaceXLength = Length<spaceX>
```

> çŸ¥è¯†ç‚¹ï¼š`T['length'] / readonly`

### é¢˜ç›®è§£æ

åœ¨ä¸Šä¸€é¢˜ *4. æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ * å·²ç»æåˆ°ï¼šå¯ä»¥é€šè¿‡ `T['length']` æ‹¿åˆ°æ•°ç»„ç±»å‹ T çš„é•¿åº¦ã€‚

åŒæ—¶ï¼Œåœ¨å¤§æŒ‘æˆ˜ï¼ˆä¸€ï¼‰ä¸­ä¹Ÿæåˆ°ï¼š`type tesla = ['tesla']` è¿™æ ·å›ºå®šä¸å˜çš„å…ƒç»„å¯ä»¥ç”¨ `readonly` æ¥ä¿®é¥°ã€‚

### é¢˜ç›®ç­”æ¡ˆ

``` typescript
type Length<T extends readonly any[] >
  = T['length']
```

## 6. Exclude

### æŒ‘æˆ˜å†…å®¹

å®ç°å†…ç½®çš„ `Exclude <T, U>` ç±»å‹ï¼Œä»è”åˆç±»å‹ `T` ä¸­æ’é™¤ `U` çš„ç±»å‹æˆå‘˜ï¼Œæ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ï¼š

``` typescript
// TODO: å®ç° MyExclude
type MyExclude<T, U> = any

type Result = MyExclude<
  'a' | 'b' | 'c' | 'd', 
  'a' | 'd'
> // ç»“æœä¸º 'b' | 'c'
```

> çŸ¥è¯†ç‚¹ï¼š`è”åˆç±»å‹ / extends`

### é¢˜ç›®è§£æ

å¯¹äº `T` è¿™æ ·çš„è”åˆç±»å‹è€Œè¨€ï¼Œä½œç”¨äº `extends` æ—¶ï¼Œæœ‰ä¸€æ¡ç‹¬ç‰¹çš„è§„åˆ™ï¼š

> When conditional types act on a generic type, they become distributive when given a union type.

ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼š

> åœ¨ `X extends Y` çš„æ¡ä»¶ç±»å‹è¯­å¥ä¸­ï¼Œ**è‹¥ `X` æ˜¯è”åˆç±»å‹çš„èŒƒå‹**ï¼Œåˆ™ä¼šå°†è”åˆç±»å‹çš„æ¯ä¸€ä¸ªå¯èƒ½çš„å€¼ä»£å…¥è¿›è¡Œç‹¬ç«‹è®¡ç®—ï¼Œå†å°†ç»“æœé€šè¿‡ `|` ç»„åˆèµ·æ¥ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œ`ToArray<string | number>` çš„ç»“æœå…¶å®æ˜¯ `ToArray<string> | ToArray<number`ï¼š

``` typescript
type ToArray<Type>
  = Type extends any ? Type[] : never

// StrArrOrNumArr ä¸º string[] | number[]
type StrArrOrNumArr = ToArray<
  string | number
>
```

æœ‰ä¸€ç‚¹éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼šå½“ä¸”ä»…å½“ **è”åˆç±»å‹çš„èŒƒå‹** æ—¶æ‰ä¼šæœ‰è¿™ç§æ•ˆæœï¼Œå¦‚æœå•å•æ˜¯è”åˆç±»å‹è€Œä¸æ¶‰åŠæ³›å‹æ—¶ï¼Œåˆ™æ˜¯ç›´æ¥æ‹¿å­—é¢é‡è¿›è¡Œåˆ¤æ–­ï¼š

``` typescript
type IsString<T>
  = T extends string ? true : false

// isA ä¸º true | false
type isA = IsString<string | number>

// isB ä¸º falseï¼Œæ­¤æ—¶ä¸æ¶‰åŠæ³›å‹
type isB
  = (string | number) extends string
    ? true : false
```

### é¢˜ç›®ç­”æ¡ˆ

ç”±äº T æ˜¯è”åˆç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥å°† T ä¸­çš„æ¯ä¸€ä¸ªç±»å‹å–å‡ºï¼Œåˆ¤æ–­å…¶æ˜¯å¦åœ¨ U ä¸­ï¼Œå¦‚æœåœ¨çš„è¯åˆ™é€šè¿‡ `never` æ’é™¤ï¼Œä¸åœ¨çš„è¯åˆ™ä¿ç•™ï¼š

``` typescript
type MyExclude<T, U>
  = T extends U ? never : T
```

## ç»“è¯­

åœ¨å®Œæˆäº†å¤§æŒ‘æˆ˜ï¼ˆä¸€ï¼‰ä¹‹åï¼Œç¬”è€…æ˜æ˜¾æ„Ÿè§‰è¿›è¡Œï¼ˆäºŒï¼‰çš„æ—¶å€™é€Ÿåº¦æå‡äº†ï¼Œä¸çŸ¥é“å¤§å®¶æ˜¯å¦ä¹Ÿæœ‰è¿™æ ·çš„æ„Ÿè§‰å‘¢ğŸ¤”